\documentclass[aspectratio=169]{beamer}
\usepackage[utf8]{luainputenc}
\usepackage[TS1,T1]{fontenc}
\usepackage{babel}
\usetheme[pagenum,navbar,ddc]{tud}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{tikz}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{hyperref}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{pifont}
\usepackage{listings}

\hypersetup{
    colorlinks=false,
    linkcolor=black,
    filecolor=magenta,      
    urlcolor=black,
}

\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}

\lstset{ 
  backgroundcolor=\color{white},   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}; should come as last argument
  basicstyle=\footnotesize\ttfamily,        % the size of the fonts that are used for the code
  breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace
  breaklines=true,                 % sets automatic line breaking
  captionpos=n,                    % sets the caption-position to bottom
  commentstyle=\color{mygreen},    % comment style
  deletekeywords={...},            % if you want to delete keywords from the given language
  escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
  extendedchars=true,              % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
  firstnumber=0,                % start line enumeration with line 1000
  frame=single,	                   % adds a frame around the code
  keepspaces=true,                 % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
  keywordstyle=\color{blue},       % keyword style
  language=Octave,                 % the language of the code
  morekeywords={*,...},            % if you want to add more keywords to the set
  numbers=left,                    % where to put the line-numbers; possible values are (none, left, right)
  numbersep=5pt,                   % how far the line-numbers are from the code
  numberstyle=\tiny\color{mygray}, % the style that is used for the line-numbers
  rulecolor=\color{black},         % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
  showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
  showstringspaces=false,          % underline spaces within strings only
  showtabs=false,                  % show tabs within strings adding particular underscores
  stepnumber=2,                    % the step between two line-numbers. If it's 1, each line will be numbered
  stringstyle=\color{mymauve},     % string literal style
  tabsize=2,	                   % sets default tabsize to 2 spaces
  title=\lstname                   % show the filename of files included with \lstinputlisting; also try caption instead of title
}

\title[System Monitoring via Hardware Performance Counter and TEE Design]{System Monitoring via Hardware Performance Counter and TEE Design}
\author{Pascal Scholz}
\einrichtung{Dresden University of Technology}
\institut{Institute of Systems Architecture}
\professur{Chair of Operating Systems}
\einrichtung{}
\date{November 8th, 2024}

\newcommand*\inmm[1]{\pgfmathsetmacro\inmmwert{#1 / 1mm}\inmmwert}
\makeatletter
\newcommand*\inpt[1]{\setlength\@tempdima{#1}\the\@tempdima}
\makeatother

\AtBeginSection[]{\partpage{\usebeamertemplate***{part page}}}
\begin{document}

\newcommand{\greencheck}{}%
\DeclareRobustCommand{\greencheck}{%
    \tikz\fill[scale=0.4, color=teal]
    (0,.35) -- (.25,0) -- (1,.7) -- (.25,.15) -- cycle;%
}

\maketitle

\mode<presentation>{\setbeamertemplate{page number in footline}[frame number]}

%-----------------------------------------------------------------------------------------------------------------------
\begin{frame}{TEE extensions in existing hardware}
    \begin{itemize}
        \item SGX: Costan, Victor. "Intel SGX explained." {\footnotesize{IACR Cryptol, EPrint Arch (2016)}}
        \item TDX: "White Paper | IntelÂ® Trust Domain Extensions" {\footnotesize{Intel Corporation, 2023}}
        \item AMD SEV-SNP: SEV-SNP, AMD. "Strengthening VM isolation with integrity protection and more." {\footnotesize{White Paper, January (2020): 1450-1465}}
        \item ARM Trustzone: Pinto, Sandro, and Nuno Santos. "Demystifying arm trustzone: A comprehensive survey." {\footnotesize{ACM computing surveys (CSUR) 51.6 (2019): 1-36}}
    \end{itemize}
\end{frame}

%-----------------------------------------------------------------------------------------------------------------------
\begin{frame}{Existing Trusted Computing extensions: Component Interaction}
    \begin{figure}
        \begin{subfigure}[]{0.23\textwidth}
            \includegraphics[width=\textwidth]{images/sgx_components.pdf}
            \caption{Intel SGX}
        \end{subfigure}
        \begin{subfigure}[]{0.23\textwidth}
            \includegraphics[width=\textwidth]{images/trustzone.png}
            \caption{ARM Trustzone}
        \end{subfigure}
        \begin{subfigure}[]{0.23\textwidth}
            \includegraphics[width=\textwidth]{images/svm-snp.png}
            \caption{AMD SEV-SNP}
        \end{subfigure}
        \begin{subfigure}[]{0.23\textwidth}
            \includegraphics[width=\textwidth]{images/tdx.png}
            \caption{Intel TDX}
        \end{subfigure}
        \caption{Communication with TEE}
    \end{figure}
\end{frame}
%-----------------------------------------------------------------------------------------------------------------------
\begin{frame}{Trusted Computing extensions: Features}
    \begin{center}
        \begin{tabular}{c|c|c|c|c}
                                         & SGX         & TDX         & SEV-NP      & TrustZone   \\
            \hline
            Isolated Execution           & \greencheck & \greencheck & \greencheck & \greencheck \\
            Data sealing                 & \greencheck & \greencheck & \greencheck & \ding{53}   \\
            Side channel mitigation      & \ding{53}   & \greencheck & \ding{53}   & \ding{53}   \\
            Memory Probing mitigation    & \greencheck & \greencheck & \greencheck & \ding{53}   \\
            Remote Attestation           & \greencheck & \greencheck & \greencheck & \ding{53}   \\
            Runs unmodified Applications & \ding{53}   & \greencheck & \greencheck & \ding{53}   \\
        \end{tabular}\\
        \bigskip
        \greencheck - Supported \space\space\space \ding{53} - Not Supported
    \end{center}
    \bigskip
    \footnotesize{Based on: Pinto, Sandro, and Nuno Santos. "Demystifying arm trustzone: A comprehensive survey." ACM computing surveys (CSUR) 51.6 (2019): 1-36.}
\end{frame}
%-----------------------------------------------------------------------------------------------------------------------
\begin{frame}{Wait, side channel attacks?...}
    \begin{figure}
        \begin{subfigure}[]{0.45\textwidth}
            \begin{center}
                \includegraphics[width=0.6\textwidth]{images/spectre.pdf}
                \onslide<1>{\caption{\footnotesize{\url{https://meltdownattack.com/spectre-text.svg}, accessed 11th Nov., 2024}}}
            \end{center}
        \end{subfigure}
        \begin{subfigure}[]{0.45\textwidth}
            \begin{center}
                \includegraphics[width=0.37\textwidth]{images/meltdown.pdf}
            \end{center}
            \caption{\footnotesize{\url{https://meltdownattack.com/meltdown-text.svg}, accessed 11th Nov., 2024}}
        \end{subfigure}
    \end{figure}
\end{frame}
%-----------------------------------------------------------------------------------------------------------------------
\begin{frame}[fragile]{Transient execution and side channels}
    \begin{center}
        \begin{figure}
            \begin{subfigure}[]{0.6\textwidth}
                \begin{lstlisting}
if (x < array1_size)
  y = array2[array1[x] * 4096];
                \end{lstlisting}
            \end{subfigure}
            \begin{subfigure}[]{0.45\textwidth}
                \begin{center}
                    \includegraphics[width=\textwidth]{images/spectre_predict.png}
                    \caption{Possible predication results}
                \end{center}
            \end{subfigure}
            \caption{Spectre attack mechanism: Kocher, Paul, et al. "Spectre attacks: Exploiting speculative execution." \footnotesize{Communications of the ACM 63.7 (2020): 93-101.}}
        \end{figure}
    \end{center}
\end{frame}
%-----------------------------------------------------------------------------------------------------------------------
\begin{frame}{... how it's going}
    \begin{figure}
        \begin{center}
            \includegraphics[width=\textwidth]{images/timeline.pdf}
        \end{center}
    \end{figure}
\end{frame}
%-----------------------------------------------------------------------------------------------------------------------
\begin{frame}{Two Questions}
    \begin{enumerate}
        \item How to detect side channel attacks?
              \bigskip
        \item How to isolate parts of the system?
    \end{enumerate}
\end{frame}
%-----------------------------------------------------------------------------------------------------------------------
\begin{frame}{Controlf Flow protection through Performance Counters}
    \begin{itemize}
        \item CFIMon: Xia, Yubin, et al. "CFIMon: Detecting violation of control flow integrity using performance counters." {\footnotesize{IEEE/IFIP International Conference on Dependable Systems and Networks (DSN 2012). IEEE, 2012}}
        \item ConFirm: Wang, Xueyang, et al. "Malicious firmware detection with hardware performance counters." {\footnotesize{IEEE Transactions on Multi-Scale Computing Systems 2.3 (2016): 160-173.}}
    \end{itemize}
\end{frame}
%-----------------------------------------------------------------------------------------------------------------------
\begin{frame}{Controlf Flow protection through Performance Counters}
    \begin{itemize}
        \item x86 offers 4 architectural PCs
        \item Additional PCs implementation specific
        \item So called core and uncore events
    \end{itemize}
\end{frame}
%-----------------------------------------------------------------------------------------------------------------------
\begin{frame}{Controlf Flow protection through Performance Counters}
    \begin{center}
        \begin{minipage}{0.5\linewidth}
            \begin{center}
                \includegraphics[width=.83\textwidth]{images/control_flow_1.pdf}
            \end{center}
        \end{minipage}
        \hfill
        \begin{minipage}{0.4\linewidth}
            \begin{center}
                \begin{tabular}{c|c|c}
                    Event      & Path A & Path B \\
                    \hline
                    Loads      & 3      & 0      \\
                    Store      & 0      & 2      \\
                    Jump       & 0      & 2      \\
                    Arithmetic & 0      & 2      \\
                \end{tabular}
            \end{center}
        \end{minipage}
    \end{center}
\end{frame}
%-----------------------------------------------------------------------------------------------------------------------
\begin{frame}{Side channel Attack detection}
    \begin{itemize}
        \item Li, Congmiao, and Jean-Luc Gaudiot. "Detecting spectre attacks using hardware performance counters." {\footnotesize{IEEE Transactions on Computers 71.6 (2021): 1320-1331.}}
        \item Lantz, David, Felipe Boeira, and Mikael Asplund. "Towards self-monitoring enclaves: Side-channel detection using performance counters." {\footnotesize{Nordic Conference on Secure IT Systems. Cham: Springer International Publishing, 2022.}}
        \item Bazm, Mohammad-Mahdi, et al. "Cache-based side-channel attacks detection through intel cache monitoring technology and hardware performance counters." {\footnotesize{2018 Third International Conference on Fog and Mobile Edge Computing (FMEC). IEEE, 2018.}}
    \end{itemize}
\end{frame}
%-----------------------------------------------------------------------------------------------------------------------
\begin{frame}{Side channel Attack detection}
    \begin{center}
        \begin{figure}
            \includegraphics[width=.6\textwidth]{images/spectre_llc_miss_distribution.png}
            \caption{{\footnotesize{Li, Congmiao, and Jean-Luc Gaudiot. "Detecting spectre attacks using hardware performance counters." IEEE Transactions on Computers 71.6 (2021): 1320-1331., p. 7}}}
        \end{figure}
    \end{center}
\end{frame}
%-----------------------------------------------------------------------------------------------------------------------
\begin{frame}{Software Enclaves}
    \begin{itemize}
        \item Enma: Hanna Reitz, Isolating Program Execution on L4Re/Fiasco.OC, 2019, Diploma Thesis
        \item Haven: Baumann, Andrew, Marcus Peinado, and Galen Hunt. "Shielding applications from an untrusted cloud with haven." {\footnotesize{ACM Transactions on Computer Systems (TOCS) 33.3 (2015): 1-26.}}
        \item OpenVMM: Microsoft 2024
    \end{itemize}
\end{frame}
%-----------------------------------------------------------------------------------------------------------------------
\begin{frame}{Architecture overview}
    \begin{figure}
        \begin{subfigure}[]{0.3\textwidth}
            \includegraphics[width=\textwidth]{images/haven.png}
            \caption{Heaven}
        \end{subfigure}
        \begin{subfigure}[]{0.3\textwidth}
            \includegraphics[width=\textwidth]{images/openvmm.png}
            \caption{OpenVMM}
        \end{subfigure}
        \begin{subfigure}[]{0.3\textwidth}
            \includegraphics[width=\textwidth]{images/enma.png}
            \caption{Enma}
        \end{subfigure}
    \end{figure}
\end{frame}
%-----------------------------------------------------------------------------------------------------------------------
\begin{frame}{TCB Comparison}
    \begin{center}
        \begin{tabular}{c|c|c|c}
                                        & Haven       & OpenVMM     & Enma        \\
            \hline
            Hardware                    & \greencheck & \greencheck & \greencheck \\
            Firmware                    & \greencheck & \greencheck & \greencheck \\
            Kernel (potentially subset) & \greencheck & \greencheck & \greencheck \\
            Additional Services         & \greencheck & \greencheck & \greencheck \\
            Root of Trust               & SGX         & TDX/SEV-SNP & TPM         \\
        \end{tabular}
        \\
        \bigskip
        \greencheck - Contained in TCB \space\space\space \ding{53} - Not contained in TCB \\
    \end{center}
\end{frame}
%-----------------------------------------------------------------------------------------------------------------------


\end{document}
