\documentclass[crop,tikz]{standalone}
\begin{document}
\begin{tikzpicture}[scale=1]
    \coordinate (x) at (0, 10);
    \node[scale=0.8, align=center] at ($ (x) + (1.375, -.2)$) {Isolated Core};
    \draw ($ (x) + (-0.25, 0)$) rectangle ($ (x) + (3, -5)$);
    \draw ($ (x) + (0, -.5)$) rectangle ($ (x) + (2.75, -1.5)$) node[pos=0.5, scale=.8, align=center] {Trusted\\Application};

    \fill[fill=none, align=left, text width= 3cm] ($ (x) + (0.675, -1.75)$) rectangle ($ (x) + (0.78, -1.75)$) node[scale=.68] {User Space};
    \draw [blue!60, dashed, thick] ($ (x) + (-0.25, -1.885) $) -- ($ (x) + (3, -1.885) $);
    \fill[fill=none, align=left, text width= 3cm] ($ (x) + (0.675, -2.05)$) rectangle ($ (x) + (0.78, -2.05)$) node[scale=.68] {Kernel Space};

    \draw ($ (x) + (0.0, -3.75)$) rectangle ($ (x) + (2.75, -4.75)$) node[pos=0.5, scale=.8, align=center] {TEECore};
    \draw [arrows = {Latex[width=5pt, length=5pt]-Latex[width=5pt, length=5pt]}] ($ (x) + (1.375, -1.5)$) -- ($ (x) + (1.375, -3.75)$);

    \draw[red!60, dashed, thick] ($ (x) + (-0.5, 0.25)$) rectangle ($ (x) + (3.25, -5.35)$);
    \node[scale=.7, align=center] at ($ (x) + (0.5, -5.2)$) {Secure Partition};

    % Memory mapped components
    \coordinate (x) at (4, 10);
    \draw ($ (x) + (0, -1.0)$) rectangle ($ (x) + (3, -2)$) node[pos=0.5, scale=.8, align=center] {Shared Memory} ;
    \draw ($ (x) + (0, -3.0)$) rectangle ($ (x) + (3, -4)$) node[pos=0.5, scale=.8, align=center] {TPM};

    \draw [arrows = {Latex[width=5pt, length=5pt]-Latex[width=5pt, length=5pt]}] ($ (x) + (-1.25, -4.45)$) -- ($ (x) + (1.5, -4.45)$) -- ($ (x) + (1.5, -4)$);
    \draw [arrows = {Latex[width=5pt, length=5pt]-Latex[width=5pt, length=5pt]}] ($ (x) + (-1.25, -4.05)$) -- ($ (x) + (-0.5, -4.05)$) -- ($ (x) + (-0.5, -1.5)$) -- ($ (x) + (0, -1.5)$);
    \draw [arrows = {Latex[width=5pt, length=5pt]-Latex[width=5pt, length=5pt]}] ($ (x) + (4.25, -4.25)$) -- ($ (x) + (3.5, -4.25)$) -- ($ (x) + (3.5, -1.5)$) -- ($ (x) + (3, -1.5)$);
    % Remaining system
    \coordinate (x) at (8, 10);
    \node[scale=0.8, align=center] at ($ (x) + (1.625, -.2)$) {Remaining System};
    \draw ($ (x) + (0, 0)$) rectangle ($ (x) + (3.25, -5)$);
    \draw ($ (x) + (0.25, -.5)$) rectangle ($ (x) + (3.0, -1.5)$) node[pos=0.5, scale=.8, align=center] {User Application};

    \fill[fill=none, align=left, text width= 3cm] ($ (x) + (0.9, -1.75)$) rectangle ($ (x) + (1.05, -1.75)$) node[scale=.68] {User Space};
    \draw [blue!60, dashed, thick] ($ (x) + (-0.0, -1.885) $) -- ($ (x) + (3.25, -1.885) $);
    \fill[fill=none, align=left, text width= 3cm] ($ (x) + (0.9, -2.05)$) rectangle ($ (x) + (1.05, -2.05)$) node[scale=.68] {Kernel Space};

    \draw ($ (x) + (0.25, -2.25)$) rectangle ($ (x) + (3.0, -3.25)$) node[pos=0.5, scale=.8, align=center] {Commodity\\Kernel};
    \draw ($ (x) + (0.25, -3.75)$) rectangle ($ (x) + (3.0, -4.75)$) node[pos=0.5, scale=.8, align=center] {TEECore Driver};
    \draw [arrows = {Latex[width=5pt, length=5pt]-Latex[width=5pt, length=5pt]}] ($ (x) + (1.625, -1.5)$) -- ($ (x) + (1.625, -2.25)$);
    \draw [arrows = {Latex[width=5pt, length=5pt]-Latex[width=5pt, length=5pt]}] ($ (x) + (1.625, -3.25)$) -- ($ (x) + (1.625, -3.75)$);

    \draw[red!60, dashed, thick] ($ (x) + (-0.25, 0.25)$) rectangle ($ (x) + (3.5, -5.35)$);
    \node[scale=.7, align=center] at ($ (x) + (0.8, -5.2)$) {Normal Partition};
\end{tikzpicture}
\end{document}
