\documentclass[crop,tikz]{standalone}
\begin{document}
\begin{tikzpicture}[scale=1]	\coordinate (x) at (0, 10);

    \draw [arrows = {|-Latex[width=5pt, length=5pt]}] ($ (x) + (0, 0)$) -- node[above, scale=0.8]{Time}($ (x) + (11.25, 0)$);
    \draw [red!60, dashed, thick]($ (x) + (-.125, -.325)$) rectangle ($ (x) + (8.375, -1.625)$);

    \draw ($ (x) + (0, -.5)$) rectangle ($ (x) + (2.3, -1.5)$) node[pos=0.5, scale=.8, align=center] {Root of Trust\\for Measurement};
    \draw [arrows = {-Latex[width=3pt, length=5pt]}] ($ (x) + (2.3, -1.0)$) -- ($ (x) + (3.0, -1.0)$);
    \draw [dashed, arrows = {-Latex[width=3pt, length=5pt]}] ($ (x) + (2.0, -1.5)$) -- ($ (x) + (2.0, -2.5)$);

    \draw ($ (x) + (3.0, -.5)$) rectangle ($ (x) + (5.25, -1.5)$) node[pos=0.5, scale=.8, align=center] {Bootloader};
    \draw [arrows = {-Latex[width=3pt, length=5pt]}] ($ (x) + (5.25, -1.0)$) -- ($ (x) + (6.0, -1.0)$);
    \draw [dashed, arrows = {-Latex[width=3pt, length=5pt]}] ($ (x) + (5.0, -1.5)$) -- ($ (x) + (5.0, -2.5)$);

    \draw ($ (x) + (6.0, -.5)$) rectangle ($ (x) + (8.25, -1.5)$) node[pos=0.5, scale=.8, align=center] {Linux};
    \draw [arrows = {-Latex[width=3pt, length=5pt]}] ($ (x) + (8.25, -1.0)$) -- ($ (x) + (9.0, -1.0)$);
    \draw [dashed, arrows = {-Latex[width=3pt, length=5pt]}] ($ (x) + (8.0, -1.5)$) -- ($ (x) + (8.0, -2.5)$);

    \draw ($ (x) + (9.0, -.5)$) rectangle ($ (x) + (11.25, -1.5)$) node[pos=0.5, scale=.8, align=center] {TEECore};

    \draw ($ (x) + (0.0, -2.5)$) rectangle ($ (x) + (11.25, -3.5)$) node[pos=0.5, scale=.8, align=center] {TPM PCRs};

    % legend
    \node [scale=0.8] at ($(x) + (0.5, -4.75)$) {Legend:};
    \node [scale=0.8](A) at ($(x) + (1.2, -5)$) {A}; 	\node[right=of A, scale=0.8] (B) {B}; \node[right=of B, scale=0.8] (T) {A extends B};
    \draw [dashed, arrows = {-Latex[width=3pt, length=5pt]}] (A) -- (B);
    \node [scale=0.8](A) at ($(x) + (1.2, -5.5)$) {A}; 	\node[right=of A, , scale=0.8] (B) {B}; \node[right=of B, scale=0.8] (T) {A transfers control to B};
    \draw [arrows = {-Latex[width=3pt, length=5pt]}] (A) -- (B);
    \draw [red!60, dashed, thick]($ (x) + (1.0, -5.75)$) rectangle ($ (x) + (2.75, -6.25)$) node[black, pos=0.5, scale=.8, align=center] (R) {A};
    \node [scale=0.8] at ($(R) + (4.27, 0)$) {A contained in TEECore's TCB};
\end{tikzpicture}
\end{document}
